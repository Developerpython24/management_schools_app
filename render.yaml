services:
  - type: web
    name: school-management
    env: python
    region: frankfurt # Ù…Ù†Ø·Ù‚Ù‡ Ø§Ø±ÙˆÙ¾Ø§ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø§ÛŒØ±Ø§Ù†ÛŒ
    plan: starter
    rootDir: /
    buildCommand: |
      echo "ğŸš€ Starting secure build process..."
      pip install -r requirements.txt
      echo "âœ… Dependencies installed"
      flask db upgrade
      echo "âœ… Database migrated"
    startCommand: "gunicorn --worker-class gevent --workers 3 --timeout 60 --bind 0.0.0.0:$PORT run:app"
    envVars:
      - key: FLASK_ENV
        value: production
      - key: SECRET_KEY
        generateValue: true # render.com ÛŒÚ© Ú©Ù„ÛŒØ¯ ØªØµØ§Ø¯ÙÛŒ Ø§Ù…Ù† ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
      - key: SUPER_ADMIN_USERNAME
        sync: false # Ø¨Ø§ÛŒØ¯ Ø¯Ø³ØªÛŒ ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆØ¯
      - key: SUPER_ADMIN_PASSWORD
        generateValue: true # render.com ÛŒÚ© Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ù‚ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
      - key: DATABASE_URL
        fromDatabase:
          name: school-db
          property: connectionString
      - key: SMS_ACTIVE
        value: "False"
      - key: MAIL_USE_TLS
        value: "True"
    healthCheckPath: /health
    healthCheckInterval: 60
    autoDeploy: true

databases:
  - name: school-db
    databaseName: school_management
    user: school_user
    plan: starter
    ipAllowList:
      - source: 0.0.0.0/0 # ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡ - Ø¯Ø± production Ù…Ø­Ø¯ÙˆØ¯ Ú©Ù†ÛŒØ¯
